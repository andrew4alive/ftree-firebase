<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-styles/color.html">



<dom-module id="ftree-member-child">
  <template>
    <style>
      :host {
        display: inline;



      }
      paper-button{
        border: medium solid #FDF3E7;
        font-size: 100%;
        margin: 1%;
        font-style: normal;
      }
      addftree-member{
        position: fixed;
        height:0px;

      }
      img{
        height: 25px;
        width: 25px;
      }

      /*  css for tree */
      ul{
        
      }
      li{
        isplay: inline;
        text-align: center;
        list-style-type: none;
        border-style: solid;
        border-color: black;
        border-width: thin;
      }

    </style>



       <ul>
         <template id="member" is="dom-repeat" items="[[memberlist]]">

              <li>
                <a parent$= "[[me]]" on-click="showmember">
                [[item.name]]
                [[item.spouse.name]]
                <br/>
                <template is="dom-if" if="[[item.photo]]">
                  <img src="{{item.photo}}">
                </template>
              </a>


               <template id="childrepeat" is="dom-repeat" items="[[objecttoarraychild(item.c)]]">
                  <ftree-member-child member="[[member]]"
                   users="[[users]]" me="[[item]]"></ftree-member>
                </template>

              </li>

         </template>

       </ul>




  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class ftreeMemberChild extends Polymer.Element {
      static get is() { return 'ftree-member-child'; }
      static get properties() {
        return {
          users:{
            type:Object
          },
         member:{
           type:Object,

           observer:'fob'
         },
         memberlist:{
           type:Object,readonly:true
           ,observer:'mlob'
         },

         me:{
           type:String,
           value:null
         },
         memberchildlist:{
           type:Object,
           observer:"mcob"
         },
         master:{
           type:Boolean,
           value:true
         }


        };
      }
       fob(n,o){
        //  console.log(n,this.me);
          var self= this;
          if(n==null||typeof n[self.me] =='undefined'){
            self.memberlist=[];
            return false;
          }

          self.memberlist = [n[self.me]];
          self.memberchildlist = [];
          var mckeys = Object.keys(n[self.me]);
          if(mckeys.indexOf("c")>=0)
            self.memberchildlist = Object.keys(n[self.me]['c']);

       }
       mlob(n,o){
      //  console.log(n,this.shadowRoot.childNodes);
       }
       mcob(n,o){
         console.log(n);
       }

      ready(){
        super.ready();
      //  console.log(this.$.childrepeat);
      }


      //event
      addchild(e){
         var p = e.currentTarget.getAttribute('parent');
         var ce =  new CustomEvent('addfire',{detail:p});
         window.dispatchEvent(ce);
      }

      addparent(e){
        var p = e.currentTarget.getAttribute('parent');
        var ce =  new CustomEvent('addfire-parent',{detail:p});
        window.dispatchEvent(ce);

      }

      deletechild(e){


        var p = e.currentTarget.getAttribute('parent');

       var ce =  new CustomEvent('deletefire',{detail:p});
       window.dispatchEvent(ce);


      }

      showmember(e){

        var p = e.currentTarget.getAttribute('parent');

       var ce =  new CustomEvent('showmember',{detail:p});
       window.dispatchEvent(ce);

      }




///hlper function
    objecttoarraychild(item){
      if (item==null||typeof item == undefined ) return null;
      var arr = [];
      for(var i in item){
        if(i in this.member)
        arr.push(i.toString())

      }

      return arr;
    }

      membername(ckey){
        var self = this;
        var keys = Object.keys(self.member);
        if(keys.indexOf(ckey)>=0)
       return   self.member[ckey]['name'];
       return "no child";
      }


    }

    window.customElements.define(ftreeMemberChild.is, ftreeMemberChild);
  </script>
</dom-module>
