<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/polymer/lib/elements/dom-if.html"><link rel="import" href="../../bower_components/polymer/lib/elements/dom-repeat.html"><link rel="import" href="../../bower_components/paper-button/paper-button.html"><link rel="import" href="../../bower_components/paper-styles/color.html"><link rel="import" href="../../bower_components/paper-input/paper-input.html"><link rel="import" href="../../bower_components/iron-form/iron-form.html"><link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html"><link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html"><link rel="import" href="./addftree-form.html"></head><body><dom-module id="ftree-form"><template strip-whitespace=""><style>:host{display:inline;}paper-button{float:right;}paper-dialog{}.hide{height:0px;}.show{height:100%;}div{overflow:hidden;}</style><paper-dialog id="addftreemember" on-opened-changed="dialogchange"><div id="main" class="show"><paper-toggle-button active="{{edit}}" id="edit">Edit</paper-toggle-button><paper-input type="text" name="name" label="Name" always-float-label="" disabled="{{!edit}}" value="[[display.name]]" error-message="more than 1 char" minlength="1"></paper-input><paper-toggle-button checked="{{spouse}}" disabled="{{!edit}}">Marry</paper-toggle-button><template is="dom-if" if="[[spouse]]"><paper-input type="text" name="spousename" always-float-label="" disabled="{{!edit}}" label="Spouse name" value="[[display.spouse.name]]"></paper-input></template><template is="dom-if" if="[[edit]]"><paper-button on-click="update" style="color:black;clear:right">Update</paper-button><paper-button on-click="delete" style="color:black;clear:left">Delete</paper-button></template><template is="dom-if" if="[[users]]"><template is="dom-if" if="[[!edit]]"><paper-button customtarget="child" on-click="addchild" style="color:black;clear:right">add member</paper-button></template></template><paper-button dialog-dismiss="" style="color:black;clear:right">Cancel</paper-button></div><div id="add" class="hide"><addftree-form closeform="[[closeformpass()]]" id="addform2"></addftree-form></div></paper-dialog></template><script>class ftreeForm extends Polymer.Element{static get is(){return'ftree-form'}static get properties(){return{meid:{type:String,value:null},users:{type:Object,value:null},formdata:{type:Object,observer:'formdataob'},appear:{type:Boolean,value:!1,observer:'appearob'},spouse:{type:Boolean,value:!1,observer:'spouseob'},edit:{type:Boolean,value:!1,observer:'editob'},editdata:{type:Object,value:null},display:{type:Object},field:{type:Object,value:[]},appearcb:{type:Function,value:null}}}formdataob(a){var b=this;b.display=a,b.spouse=b.havespouse(b.formdata),'object'==typeof a&&null!=a&&(b.editdata=JSON.parse(JSON.stringify(b.formdata)))}appearob(a){null!=this.appearcb&&this.appearcb.action(a),a&&null!=this.$.addftreemember&&this.$.addftreemember.open(),!1==a&&null!=this.$.addftreemember&&this.$.addftreemember.close()}editob(){var a=this;!0==a.edit?(a.display=a.editdata,a.spouse=a.havespouse(a.editdata)):(a.display=a.formdata,a.spouse=a.havespouse(a.formdata))}spouseob(a){var b=this,c=b.edit,d=Object.keys(b.formdata);c&&(a?d.indexOf(!1)&&(b.editdata.spouse=b.formdata.spouse):delete b.editdata.spouse)}ready(){super.ready()}dialogchange(a){this.appear=a.detail.value,!1==a.detail.value&&(this.formdata={}),this.edit=!1}havespouse(a){if('object'!=typeof a)return!1;var b=Object.keys(a);return 0<b.length&&0<=b.indexOf('spouse')}update(){var a=this,b=a.getformjson(a.$.main.childNodes),c={};c[a.meid]={},c[a.meid]=a.editdata;var e=Object.keys(b);if(0<e.length){0<=e.indexOf('name')&&(c[a.meid].name=b.name),0<=e.indexOf('spousename')&&a.spouse?(c[a.meid].spouse={},c[a.meid].spouse.name=b.spousename):delete c[a.meid].spouse;var f=new CustomEvent('updateself',{detail:c});window.dispatchEvent(f)}}delete(){var a=new CustomEvent('deletefire',{detail:this.meid});window.dispatchEvent(a)}addchild(a){var b=this,c=a.currentTarget.getAttribute('customtarget');b.$.addform2.formdata={},b.$.addform2.meid=b.meid,b.$.main.className='hide',b.$.add.className='show'}getformjson(a){for(var b=this,c={},d=0;d<a.length;d++)'PAPER-INPUT'==a[d].tagName&&(c[a[d].name]=a[d].value);return c}closeformpass(){var a=this;return function(){a.$.main.className='show',a.$.add.className='hide'}}}window.customElements.define(ftreeForm.is,ftreeForm);</script></dom-module></body></html>