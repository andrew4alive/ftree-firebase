<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/polymer/lib/elements/dom-if.html"><link rel="import" href="../../bower_components/paper-button/paper-button.html"><link rel="import" href="../../bower_components/paper-styles/color.html"><link rel="import" href="./welcome-page.html"><link rel="import" href="./ftree-manage.html"><link rel="import" href="./fb-share.html"><link rel="import" href="./page-404.html"></head><body><dom-module id="ftree-app"><template><style>:host{display:block;background-color:#C63D0F;}.logout{background-color:#FDF3E7;position:fixed;top:10px;right:10px;z-index:1;}</style><template is="dom-if" if="[[!pagenf]]"><template is="dom-if" if="{{users}}" restamp="true"><paper-button raised="true" class="logout" on-click="logout">Logout</paper-button><ftree-manage users="{{users}}" pageid="[[pageid]]"></ftree-manage><fb-share pageid="{{pageid}}"></fb-share></template><template is="dom-if" if="[[!users]]" restamp="true"><template is="dom-if" if="{{!pageid}}" restamp="true"><fb-share></fb-share><welcome-page users="{{users}}" on-loginaction="loginmethod"></welcome-page></template><template is="dom-if" if="[[pageid]]" restamp="true"><fb-share pageid="{{pageid}}"></fb-share><ftree-manage users="{{users}}" pageid="[[pageid]]"></ftree-manage></template></template></template><template is="dom-if" if="[[pagenf]]"><page-404></page-404></template><span class="dummy" style="display:none"><img src="/src/ftree-app/icon/pot.png"> <img src="/src/ftree-app/icon/sun.png"> <img src="/src/ftree-app/icon/marry.png"> <img src="/src/ftree-app/icon/tree.png"></span></template><script src="https://www.gstatic.com/firebasejs/4.6.0/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/4.6.0/firebase-auth.js"></script><script src="https://www.gstatic.com/firebasejs/4.6.0/firebase-database.js"></script><script type="text/javascript" src="fireconfig.js"></script><script>class FtreeApp extends Polymer.Element{static get is(){return'ftree-app'}static get properties(){return{users:{type:Object,value:function(){return null},observer:'userschange'},pageid:{type:String,value:null},iswelcome:{type:Boolean,value:!1},pagenf:{type:Boolean,value:!1}}}static get observers(){return['_pagemanager(users,pageid)']}userschange(){}_pagemanager(){var a=this;'string'==typeof a.pageid?firebase.database().ref('ftree/users/'+a.pageid).once('value').then(function(b){var c=b.val();null==c&&(a.pagenf=!0)}):a.pagenf=!1}ready(){super.ready(),self=this,firebase.auth().onAuthStateChanged(function(a){self.users=a?a:null}),self.pageid=this._hashquery('pageid'),window.onhashchange=function(){self.pageid=self._hashquery('pageid')}}connectedCallback(){super.connectedCallback();this}disconnectedCallback(){super.disconnectedCallback();this}_hashquery(a){var b=window.location.hash,c=[];if('#'==b[0]?b=b.substring(1,b.length):'#/'==b[0]&&(b=b.substring(2,b.length)),''==b)return!1;c=b.split('&');for(var d,e=0;e<c.length;e++)if(d=c[e].split('='),2<=d.length&&d[0]==a)return d[1];return null}loginmethod(){console.log('login action from free-app'),self=this;var a=new firebase.auth.GoogleAuthProvider;firebase.auth().signInWithPopup(a).then(function(){}).catch(function(a){console.log('sign in error:'+a);var b=a.code,c=a.message,d=a.email,e=a.credential})}logout(){firebase.auth().signOut().then(function(){location.reload()}).catch(function(){})}_eq(c,a){return c==a}}window.customElements.define(FtreeApp.is,FtreeApp);</script></dom-module></body></html>